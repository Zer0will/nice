<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/OnlineOrder.css" />
    <link rel="stylesheet" href="css/global-nav.css">
    
    <style>
        body {
            margin-top: 100px;
            background: #0f0f0f;
            color: white;
        }

        .home-hero-text {
            max-width: 625px;
            font-family: "Poppins";
            font-size: 18px;
            margin: 40px 0px;
        }

        .home-hero-heading {
            font-size: 80px;
            font-family: "Poppins";
            line-height: 90px;
        }

        .home-hero-heading span {
            font-weight: bold;
        }

        .reser-button {
            border-radius: 24px;
            background: linear-gradient(90deg, #f7efc1 0%, #e0bc6b 100%);
            display: inline-flex;
            height: 44px;
            padding: 6px 32px;
            justify-content: center;
            align-items: center;
            gap: 10px;
            color: #232323;
            font-family: "Poppins";
            font-size: 18px;
            width: fit-content;
        }

        .ab-small {
            width: 320px;
            height: 280px;
        }

        .ab-l {
            width: 320px;
        }

        input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            width: 20px;
            height: 20px;
            background-color: transparent;
            border: 2px solid white;
            
            cursor: pointer;
            position: relative;
            border-radius: 4px;
            
        }


        input[type="checkbox"]:checked {
            background-color: yellow;
            
            border-color: black;
            
        }

        input[type="checkbox"]:checked::after {
            content: "âœ”";
            font-size: 14px;
            color: black;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
        }


        @media (max-width: 1200px) {
            .ab-small {
                width: 200px;
                height: 180px;
            }

            .ab-l {
                width: 200px;
            }
        }

        @media (max-width: 600px) {
            .ab-small {
                width: 260px;
                height: 240px;
            }

            .ab-l {
                width: 260px;
            }

            .home-hero-heading {
                font-size: 40px;
            }
        }
    </style>
</head>

<body>
    <div class="home-hero-bg">
       
        <div id="header"></div>


        <!-- Page Content -->
        <div class="heroContainer">
            <div class="welcome-heading">
                Welcome to Plate of Africa Online Ordering
            </div>
            <div class="enjoyText">
                Enjoy the convenience of ordering your favorite dishes online. Explore our menu and indulge in a
                culinary experience like no other.
            </div>
        </div>

        <div class="heroContainer">
            <div class="sumaryMainOuter">
                <div class="sumaryMain">
                    <div class="summaryText">Summary</div>
                    <div class="productMainOuter">
                        <img src="./assets/images/productListing.png" class="productListing-Image" alt="">
                        <div class="productMainSection">
                            <img src="./assets/images//product1.png" class="productImg" alt="">
                            <div class="productDetailSection">


                                <div class="productNameouter">
                                    <div class="productName">Liberian Fried Okra</div>
                                    <input type="checkbox" checked>
                                </div>
                                <div class="productDetailText">
                                   ${item.description}
                                </div>
                                <div class="priceSection">
                                    <div class="priceText">100.84 US$</div>
                                    <div class="selectedNumber">
                                        <div class="minusDiv" onclick="decrementItem(0)">-</div>
                                        <div class="SelectedDiv" id="counter">2</div>
                                        <div class="plusDiv" onclick="incrementItem(0)">+</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="productMainOuter">
                        <img src="./assets/images/productListing.png" class="productListing-Image" alt="">
                        <div class="productMainSection">
                            <img src="./assets/images//product2.png" class="productImg" alt="">
                            <div class="productDetailSection">


                                <div class="productNameouter">
                                    <div class="productName">African Spice Grilled Vegetable Skewers</div>
                                    <input type="checkbox" checked>
                                </div>
                                <div class="productDetailText">
                                    Lorem ipsum dolor sit amet consectetur. Dolor enim faucibus porttitor a fringilla.
                                    Placerat malesuada facilisis sed sed a
                                </div>
                                <div class="priceSection">
                                    <div class="priceText">100.84 US$</div>
                                    <div class="selectedNumber">
                                        <div class="minusDiv" onclick="decrementItem(1)">-</div>
                                        <div class="SelectedDiv" id="counter">2</div>
                                        <div class="plusDiv" onclick="incrementItem(1)">+</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="productMainOuter">
                        <img src="./assets/images/productListing.png" class="productListing-Image" alt="">
                        <div class="productMainSection">
                            <img src="./assets/images//product3.png" class="productImg" alt="">
                            <div class="productDetailSection">


                                <div class="productNameouter">
                                    <div class="productName">Bunny Chow</div>
                                    <input type="checkbox">
                                </div>
                                <div class="productDetailText">
                                    Lorem ipsum dolor sit amet consectetur. Dolor enim faucibus porttitor a fringilla.
                                    Placerat malesuada facilisis sed sed a
                                </div>
                                <div class="priceSection">
                                    <div class="priceText">100.84 US$</div>
                                    <div class="selectedNumber">
                                        <div class="minusDiv" onclick="decrementItem(2)">-</div>
                                        <div class="SelectedDiv" id="counter">2</div>
                                        <div class="plusDiv" onclick="incrementItem(2)">+</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="productMainOuter">
                        <img src="./assets/images/productListing.png" class="productListing-Image" alt="">
                        <div class="productMainSection">
                            <img src="./assets/images//product4.png" class="productImg" alt="">
                            <div class="productDetailSection">


                                <div class="productNameouter">
                                    <div class="productName">Liberian Fried Okra</div>
                                    <input type="checkbox">
                                </div>
                                <div class="productDetailText">
                                    Lorem ipsum dolor sit amet consectetur. Dolor enim faucibus porttitor a fringilla.
                                    Placerat malesuada facilisis sed sed a
                                </div>
                                <div class="priceSection">
                                    <div class="priceText">100.84 US$</div>
                                    <div class="selectedNumber">
                                        <div class="minusDiv" onclick="decrementItem(3)">-</div>
                                        <div class="SelectedDiv" id="counter">2</div>
                                        <div class="plusDiv" onclick="incrementItem(3)">+</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="orderSectionOuter">
                    <div class="ordertEXT">Order Summary</div>
                    <div id="dynamicCartItems"></div>
                    
                    <div class="totalASection">
                        <div class="productLisOuter">
                            <div class="liberianText">Subtotal</div>
                            <div class="abountTxet" id="subtotalAmount">$0.00</div>
                        </div>

                        <div class="productLisOuter">
                            <div class="liberianText">Total Sales Tax (10.25%)</div>
                            <div class="abountTxet" id="salesTaxAmount">$0.00</div>
                        </div>

                        <div class="productLisOuter">
                            <div class="liberianText">Washington Spirit Alcohol Tax (20.5%)</div>
                            <div class="abountTxet" id="alcoholTaxAmount">$0.00</div>
                        </div>

                        <div class="productLisOuter" style="border-top: 1px solid #333; padding-top: 10px;">
                            <div class="liberianText" style="font-weight: bold;">Total</div>
                            <div class="abountTxet" id="grandTotalAmount" style="font-weight: bold;">$0.00</div>
                        </div>

                    </div>
                    <div class="paytext">Payment</div>
                    <div class="payBtnsouter">
                        <div class="paypalBtnSelected" id="paypalBtn">
                            <img src="./assets/images/paypalLogo.png" alt="PayPal Logo">
                            <img src="./assets/images/paypalTextBlack.png" alt="PayPal Text Black"
                                class="paypalTextBlack">
                            <img src="./assets/images/paypalTextWhite.png" alt="PayPal Text White"
                                class="paypalTextWhite">
                        </div>
                        <div class="paypalBtnUnselected" alt="Visa" id="visaBtn">
                            <img src="./assets/images/visaTextBlue.png">
                            <img src="./assets/images/visaLogo.png">
                        </div>
                    </div>
                    <div class="visaSection" id="visaSection">
                        <div class="cardHolderText">Cardholder's Name</div>
                        <input type="text" class="cardHolderInput" placeholder="Cardholder's Name">
                        <div class="cardHolderText">Card Number</div>
                        <input type="text" class="cardHolderInput" placeholder="Card Number">
                        <div class="cardexpirySection">
                            <div class="cardexpirySectionOuter">
                                <div class="cardHolderText">Card Number</div>
                                <input type="date" class="cardHolderInput" placeholder="Expiration date (MM /YY)">
                            </div>
                            <div class="cardexpirySectionOuter">
                                <div class="cardHolderText">CVC</div>
                                <input type="text" class="cardHolderInput" placeholder="CVC">
                            </div>
                        </div>
                        <div class="cardHolderText">Discount Code</div>
                        <div class="dicountSection">
                            <input type="text" class="cardHolderInput" placeholder="CHIKAMSO-20-OFF">
                            <div class="applytext">Apply</div>
                        </div>
                    </div>
                    <div class="payPalSection" id="paypalSection">
                        <div class="cardexpirySection">
                            <div class="cardexpirySectionOuter">
                                <div class="cardHolderText">First Name</div>
                                <input type="text" class="cardHolderInput" placeholder="First Name">
                            </div>
                            <div class="cardexpirySectionOuter">
                                <div class="cardHolderText">Last Name</div>
                                <input type="text" class="cardHolderInput" placeholder="Last Name">
                            </div>
                        </div>
                        <div class="cardHolderText">Card Number</div>
                        <input type="text" class="cardHolderInput" placeholder="Enter Card Number">
                        <div class="cardHolderText">Email</div>
                        <input type="text" class="cardHolderInput" placeholder="Email">
                    </div>
                    <button class="checkOutBtn" id="checkoutBtn" disabled>Checkout Unavailable</button>
                    <div class="BackMenuText" id="backToMenuBtn">Back to Menu</div>
                </div>
            </div>
        </div>

        <div class="orderbgLoweer">
            <img src="./assets//images/orderPageBg.png" class="orderPageBg" alt="">
            <img src="./assets/images/moveupArrow.png" class="moveupArrow" alt="Move Up Arrow">
        </div>

        <!-- Footer -->
        <div id="footer"></div>
    </div>

    <script src="script.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/Order.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />

    <script>
    // Constants
    const ALCOHOL_TAX_RATE = 0.205;
    const SALES_TAX_RATE = 0.1025;
    
    // Global cart data
    let cartItemsData = [];

    document.addEventListener("DOMContentLoaded", function() {
        // Initialize the page
        loadCartItems();
        setupEventListeners();
        setupBackToMenuButton();
        setupCheckoutButton();
    });

    function loadCartItems() {
        const cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
        const dynamicCartItems = document.getElementById("dynamicCartItems");
        
        if (!dynamicCartItems) return;
        
        dynamicCartItems.innerHTML = "";
        cartItemsData = [];
        
        // Create cart items display
        cartItems.forEach((item, index) => {
            const price = parseFloat(item.price.replace("$", "")) || 0;
            const itemTotal = price * item.productQuantity;
            const cartCheckboxId = `cart-item-${index}`;
            
            cartItemsData.push({
                index,
                name: item.name,
                price: price,
                quantity: item.productQuantity,
                total: itemTotal,
                isAlcohol: item.isAlcohol || false,
                cartCheckboxId,
                checked: true
            });
            
            const itemElement = document.createElement("div");
            itemElement.className = "productLisOuter";
            itemElement.innerHTML = `
                <div class="productNameouter" style="display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="${cartCheckboxId}" checked>
                    <div class="liberianText">${item.name}</div>
                </div>
                <div class="abountTxet item-price" data-price="${itemTotal.toFixed(2)}">$${itemTotal.toFixed(2)}</div>
            `;
            
            dynamicCartItems.appendChild(itemElement);
            
            // Update quantity displays in product sections
            const quantityElements = document.querySelectorAll('.SelectedDiv');
            if (quantityElements[index]) {
                quantityElements[index].textContent = item.productQuantity;
            }
        });
        
        if (cartItems.length === 0) {
            const emptyCartMessage = document.createElement("div");
            emptyCartMessage.className = "productLisOuter";
            emptyCartMessage.innerHTML = `
                <div class="liberianText" style="color: #999; text-align: center; width: 100%;">Your cart is empty</div>
            `;
            dynamicCartItems.appendChild(emptyCartMessage);
        }
        
        removeCheckboxesFromSummary();
        setupCheckboxListeners();
        updateTotal();
    }

    function removeCheckboxesFromSummary() {
        document.querySelectorAll('.sumaryMain .productNameouter input[type="checkbox"]').forEach(checkbox => {
            const parent = checkbox.parentElement;
            if (parent) {
                checkbox.remove();
                parent.style.display = 'flex';
                parent.style.justifyContent = 'space-between';
            }
        });
    }

    function setupCheckboxListeners() {
        cartItemsData.forEach(item => {
            const cartCheckbox = document.getElementById(item.cartCheckboxId);
            if (cartCheckbox) {
                cartCheckbox.addEventListener('change', function() {
                    item.checked = this.checked;
                    updateTotal();
                });
            }
        });
    }

    function setupEventListeners() {
        // Quantity buttons
        document.querySelectorAll('.plusDiv').forEach((button, index) => {
            button.addEventListener('click', () => incrementItem(index));
            button.setAttribute('data-index', index);
        });

        document.querySelectorAll('.minusDiv').forEach((button, index) => {
            button.addEventListener('click', () => decrementItem(index));
            button.setAttribute('data-index', index);
        });

        // Payment method toggles
        document.getElementById("paypalBtn")?.addEventListener('click', () => togglePaymentMethod('paypal'));
        document.getElementById("visaBtn")?.addEventListener('click', () => togglePaymentMethod('visa'));
    }

    function incrementItem(index) {
        if (index >= 0 && index < cartItemsData.length) {
            cartItemsData[index].quantity++;
            updateItemDisplay(index);
            updateTotal();
            updateCartInLocalStorage();
        }
    }

    function decrementItem(index) {
        if (index >= 0 && index < cartItemsData.length && cartItemsData[index].quantity > 1) {
            cartItemsData[index].quantity--;
            updateItemDisplay(index);
            updateTotal();
            updateCartInLocalStorage();
        }
    }

    function updateItemDisplay(index) {
        const item = cartItemsData[index];
        item.total = item.price * item.quantity;
        
        // Update quantity in product section
        const quantityElements = document.querySelectorAll('.SelectedDiv');
        if (quantityElements[index]) {
            quantityElements[index].textContent = item.quantity;
        }
        
        // Update price in cart summary
        const priceElements = document.querySelectorAll('.item-price');
        if (priceElements[index]) {
            priceElements[index].textContent = `$${item.total.toFixed(2)}`;
            priceElements[index].setAttribute('data-price', item.total.toFixed(2));
        }
    }

    function updateTotal() {
        const subtotalElement = document.getElementById("subtotalAmount");
        const salesTaxElement = document.getElementById("salesTaxAmount");
        const alcoholTaxElement = document.getElementById("alcoholTaxAmount");
        const grandTotalElement = document.getElementById("grandTotalAmount");

        let subtotal = 0;
        let alcoholSubtotal = 0;
        let nonAlcoholSubtotal = 0;
        let hasAlcohol = false;

        // Recalculate all totals based on current quantities
        cartItemsData.forEach(item => {
            // First update the item's total based on current quantity
            item.total = item.price * item.quantity;
            
            if (item.checked) {
                subtotal += item.total;
                if (item.isAlcohol) {
                    alcoholSubtotal += item.total;
                    hasAlcohol = true;
                } else {
                    nonAlcoholSubtotal += item.total;
                }
            }
        });

        const salesTaxOnNonAlcohol = nonAlcoholSubtotal * SALES_TAX_RATE;
        const salesTaxOnAlcohol = alcoholSubtotal * SALES_TAX_RATE;
        const totalSalesTax = salesTaxOnNonAlcohol + salesTaxOnAlcohol;
        const alcoholTax = alcoholSubtotal * ALCOHOL_TAX_RATE;
        const totalTax = totalSalesTax + alcoholTax;
        const grandTotal = subtotal + totalTax;

        // Update all display elements
        if (subtotalElement) subtotalElement.textContent = `$${subtotal.toFixed(2)}`;
        if (salesTaxElement) salesTaxElement.textContent = `$${totalSalesTax.toFixed(2)}`;
        
        if (alcoholTaxElement) {
            if (hasAlcohol) {
                alcoholTaxElement.textContent = `$${alcoholTax.toFixed(2)}`;
                alcoholTaxElement.parentElement.style.display = "flex";
            } else {
                alcoholTaxElement.parentElement.style.display = "none";
            }
        }
        
        if (grandTotalElement) grandTotalElement.textContent = `$${grandTotal.toFixed(2)}`;
    }

    function updateCartInLocalStorage() {
        const cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
        
        cartItemsData.forEach((item, index) => {
            if (index < cartItems.length) {
                cartItems[index].productQuantity = item.quantity;
            }
        });
        
        localStorage.setItem("cartItems", JSON.stringify(cartItems));
    }

    function togglePaymentMethod(method) {
        document.getElementById("paypalSection").style.display = method === 'paypal' ? 'block' : 'none';
        document.getElementById("visaSection").style.display = method === 'visa' ? 'block' : 'none';
        
        document.getElementById("paypalBtn").className = method === 'paypal' ? 'paypalBtnSelected' : 'paypalBtnUnselected';
        document.getElementById("visaBtn").className = method === 'visa' ? 'paypalBtnSelected' : 'paypalBtnUnselected';
    }

    function setupBackToMenuButton() {
        const backToMenuBtn = document.getElementById("backToMenuBtn");
        if (backToMenuBtn) {
            backToMenuBtn.addEventListener("click", function() {
                window.location.href = "menu.html";
            });

            backToMenuBtn.style.cursor = "pointer";
            backToMenuBtn.style.textDecoration = "underline";
            backToMenuBtn.style.color = "#E1C072";
            backToMenuBtn.style.fontWeight = "bold";
            backToMenuBtn.style.transition = "all 0.3s ease";
            
            backToMenuBtn.addEventListener("mouseover", function() {
                this.style.transform = "translateY(-2px)";
                this.style.textShadow = "0 2px 4px rgba(0,0,0,0.3)";
            });
            
            backToMenuBtn.addEventListener("mouseout", function() {
                this.style.transform = "translateY(0)";
                this.style.textShadow = "none";
            });
        }
    }

    function setupCheckoutButton() {
        const checkoutBtn = document.getElementById("checkoutBtn");
        if (checkoutBtn) {
            checkoutBtn.style.backgroundColor = "#555";
            checkoutBtn.style.cursor = "not-allowed";
            checkoutBtn.style.opacity = "0.7";
            checkoutBtn.setAttribute("title", "Checkout functionality is not available at this time");
            
            checkoutBtn.addEventListener("click", function(e) {
                e.preventDefault();
                alert("Checkout is currently unavailable. Please check back later!");
            });
        }
    }

    document.getElementById("plusDiv").addEventListener("click", updateTotal);
    document.getElementById("minusDiv").addEventListener("click", updateTotal);
</script>



</body>

</html>
